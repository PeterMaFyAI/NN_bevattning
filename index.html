<!DOCTYPE html>
<html lang="sv">
  <head>
    <meta charset="utf-8" />
    <title>Neuralt nätverk för bevattning</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>Neuralt nätverk för bevattning</h1>

    <div id="network-container">
      <!-- ---------- Indatalager ---------- -->
      <div id="input-layer" class="layer">
        <h2 class="layer-title">Inmatningslager</h2>
        <div class="node-stack">
          <div class="input-node" id="input0">
            <label
              >Jordfuktighet (%)
              <input type="number" id="moisture" value="30" step="1" />
            </label>
          </div>
          <div class="input-node" id="input1">
            <label
              >Lufttemperatur (°C)
              <input type="number" id="temperature" value="20" step="1" />
            </label>
          </div>
        </div>

      </div>

      <!-- ---------- Dolt lager ---------- -->
      <div id="hidden-layer" class="layer">
        <h2 class="layer-title">Dolt lager</h2>
        <div class="node-stack">
          <div class="hidden-node" id="hidden0">
            <div class="bias-label bias-hidden" id="bias-h0">?</div>
            <div class="node-part pre" id="pre-h0">?</div>
            <div class="node-part relu">
              <svg viewBox="0 0 40 40">
                <path
                  d="M5 20H20L35 5"
                  stroke="#fff"
                  stroke-width="4"
                  fill="none"
                />
              </svg>
            </div>
            <div class="node-part post" id="post-h0">?</div>
          </div>

          <div class="hidden-node" id="hidden1">
            <div class="bias-label bias-hidden" id="bias-h1">?</div>
            <div class="node-part pre" id="pre-h1">?</div>
            <div class="node-part relu">
              <svg viewBox="0 0 40 40">
                <path
                  d="M5 20H20L35 5"
                  stroke="#fff"
                  stroke-width="4"
                  fill="none"
                />
              </svg>
            </div>
            <div class="node-part post" id="post-h1">?</div>
          </div>

          <div class="hidden-node" id="hidden2">
            <div class="bias-label bias-hidden" id="bias-h2">?</div>
            <div class="node-part pre" id="pre-h2">?</div>
            <div class="node-part relu">
              <svg viewBox="0 0 40 40">
                <path
                  d="M5 20H20L35 5"
                  stroke="#fff"
                  stroke-width="4"
                  fill="none"
                />
              </svg>
            </div>
            <div class="node-part post" id="post-h2">?</div>
          </div>
        </div>

        <div class="controls">
          <button id="calc-hidden">Beräkna lager</button>
          <select id="show-ih">
            <option value="none">Ingen</option>
            <option value="all">Alla</option>
            <option value="h0">Nod 1</option>
            <option value="h1">Nod 2</option>
            <option value="h2">Nod 3</option>
          </select>
        </div>
      </div>

      <!-- ---------- Outputlager ---------- -->
      <div id="output-layer" class="layer">
        <h2 class="layer-title">Utmatningslager</h2>
        <p class="layer-info">Bevattningen startas om värdet är positivt (&gt;0)</p>
        <div class="node-stack">
          <div class="output-wrapper">
            <div class="output-node" id="output-node">
              <div class="bias-label bias-output" id="bias-o">?</div>
              <div id="output-prob">?</div>
            </div>
          </div>
        </div>
        <div id="prediction-text">Bevattning startas: ?</div>

        <div class="controls">
          <button id="calc-output">Beräkna nod</button>
          <label style="display: flex; align-items: center; gap: 6px"
            ><input type="checkbox" id="show-ho" /> Visa kopplingar</label
          >
        </div>
      </div>

      <!-- ---------- SVG för linjer ---------- -->
      <svg id="connections" class="connections-svg"></svg>
    </div>

    <section id="manual-training-panel">
      <div id="manual-controls" class="manual-controls hidden">
        <div class="manual-grid">
          <div class="manual-cell manual-left">
            <button id="load-next-example" class="manual-btn manual-btn-next">
              Ladda nästa exempel
            </button>
            <div id="manual-example-info"></div>
          </div>
          <div class="manual-cell manual-center"></div>
          <div class="manual-cell manual-right">
            <button id="backprop-btn" class="manual-btn manual-btn-backprop">
              Bakåtpropagering
            </button>
            <div id="manual-feedback"></div>
          </div>
        </div>
      </div>
    </section>

    <section id="training-area">
      <h2>Träningsområde</h2>

      <div class="training-actions">
        <button id="toggle-training-table">Visa träningsdata</button>
        <button id="manual-training-btn">Manuell träning</button>
        <div class="auto-training-controls">
          <label for="epochs-input">
            Epoker
            <input type="number" id="epochs-input" min="1" value="50" />
          </label>
          <label for="batch-input">
            Batch-storlek
            <input type="number" id="batch-input" min="1" value="10" />
          </label>
          <label class="output-wrapper">
            <input type="checkbox" id="animate-training" checked />
            <span>Visa animationer</span>
          </label>
          <button id="auto-train-btn">Automatisk träning</button>
        </div>
        <button id="reset-weights-btn" class="secondary">
          Återställ nätverket
        </button>
      </div>

      <div id="manual-status" class="status-text"></div>
      <div id="auto-status" class="status-text"></div>

      <div id="training-table-container" class="table-container hidden"></div>

      <div class="test-actions">
        <button id="toggle-test-table">Visa testdata</button>
        <button id="evaluate-test-btn">Utvärdera på testdata</button>
      </div>
      <div id="evaluation-result" class="status-text"></div>
      <div id="test-table-container" class="table-container hidden"></div>
    </section>

    <script src="script.js"></script>
  </body>
</html>
